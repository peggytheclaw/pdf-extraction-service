<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Listening Dashboard - PDF Extraction Service</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            padding: 20px;
            background: #f7f9fc;
            border-bottom: 1px solid #e1e8ed;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .controls {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e1e8ed;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5568d3;
        }
        
        .btn-secondary {
            background: #e1e8ed;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #d1d8dd;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .posts {
            padding: 20px;
        }
        
        .post {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .post:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .post.reviewed {
            opacity: 0.5;
            background: #f7f9fc;
        }
        
        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }
        
        .post-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
            color: #666;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .badge-high {
            background: #fef3c7;
            color: #92400e;
        }
        
        .badge-medium {
            background: #dbeafe;
            color: #1e40af;
        }
        
        .badge-low {
            background: #f3f4f6;
            color: #374151;
        }
        
        .platform {
            font-weight: 600;
            color: #667eea;
        }
        
        .post-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
            color: #111;
        }
        
        .post-excerpt {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .post-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .post-actions {
            display: flex;
            gap: 10px;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }
        
        .empty-state-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        .filter-tabs {
            display: flex;
            gap: 10px;
        }
        
        .filter-tabs button {
            padding: 8px 16px;
            border: 1px solid #e1e8ed;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .filter-tabs button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .engagement {
            display: flex;
            gap: 15px;
            font-size: 0.9em;
            color: #666;
        }
        
        .last-updated {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #e1e8ed;
        }
    </style>

  <script>
    // Embedded data (no fetch needed)
    window.DASHBOARD_DATA = {"posts":[],"lastUpdated":"2026-02-09T22:07:33.139Z"};
  </script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç Social Listening Dashboard</h1>
            <p>PDF Extraction Service - Customer Discovery</p>
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">Total Found</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="newCount">0</div>
                <div class="stat-label">New</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="reviewedCount">0</div>
                <div class="stat-label">Reviewed</div>
            </div>
        </div>
        
        <div class="controls">
            <div class="filter-tabs">
                <button class="active" onclick="filterPosts('all')">All Posts</button>
                <button onclick="filterPosts('new')">New Only</button>
                <button onclick="filterPosts('reviewed')">Reviewed</button>
            </div>
            <div>
                <button class="btn btn-secondary" onclick="location.reload()">üîÑ Refresh</button>
                <button class="btn btn-danger" onclick="clearAllReviewed()">Clear Reviewed</button>
            </div>
        </div>
        
        <div class="posts" id="postsContainer">
            <!-- Posts loaded via JavaScript -->
        </div>
        
        <div class="last-updated">
            Last updated: <span id="lastUpdated">Never</span>
        </div>
    </div>
    
    <script>
        let currentFilter = 'all';
        
        // Load posts from JSON file
        async function loadPosts() {
            try {
                // Use embedded data instead of fetching
                const data = window.DASHBOARD_DATA;
                
                renderPosts(data.posts);
                updateStats(data.posts);
                
                if (data.lastUpdated) {
                    document.getElementById('lastUpdated').textContent = new Date(data.lastUpdated).toLocaleString();
                }
            } catch (e) {
                document.getElementById('postsContainer').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì≠</div>
                        <h2>No posts found yet</h2>
                        <p>The social listening tool will populate this dashboard as it finds relevant discussions.</p>
                    </div>
                `;
            }
        }
        
        function renderPosts(posts) {
            const container = document.getElementById('postsContainer');
            const reviewedPosts = getReviewedPosts();
            
            if (!posts || posts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üì≠</div>
                        <h2>No posts found</h2>
                        <p>The social listening tool will populate this dashboard as it finds relevant discussions.</p>
                    </div>
                `;
                return;
            }
            
            // Filter posts based on current filter
            let filteredPosts = posts;
            if (currentFilter === 'new') {
                filteredPosts = posts.filter(p => !reviewedPosts.has(p.id));
            } else if (currentFilter === 'reviewed') {
                filteredPosts = posts.filter(p => reviewedPosts.has(p.id));
            }
            
            if (filteredPosts.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">‚ú®</div>
                        <h2>Nothing to show</h2>
                        <p>Try a different filter.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredPosts.map(post => {
                const isReviewed = reviewedPosts.has(post.id);
                const score = post.score || 0;
                const valueBadge = score >= 70 ? 'high' : score >= 50 ? 'medium' : 'low';
                const valueLabel = score >= 70 ? 'HIGH VALUE' : score >= 50 ? 'MEDIUM' : 'LOW';
                
                return `
                    <div class="post ${isReviewed ? 'reviewed' : ''}" data-id="${post.id}">
                        <div class="post-header">
                            <div class="post-meta">
                                <span class="platform">${post.platform}</span>
                                ${post.subreddit ? `<span>${post.subreddit}</span>` : ''}
                                <span class="badge badge-${valueBadge}">${valueLabel} (${score})</span>
                            </div>
                            <div class="engagement">
                                <span>‚Üë ${post.upvotes || 0}</span>
                                <span>üí¨ ${post.comments || 0}</span>
                                <span>${post.hoursAgo}h ago</span>
                            </div>
                        </div>
                        
                        <div class="post-title">${escapeHtml(post.title)}</div>
                        
                        ${post.excerpt ? `<div class="post-excerpt">${escapeHtml(post.excerpt)}</div>` : ''}
                        
                        <div class="post-footer">
                            <a href="${post.url}" target="_blank" class="btn btn-primary">View Discussion ‚Üí</a>
                            <div class="post-actions">
                                ${!isReviewed ? `
                                    <button class="btn btn-secondary" onclick="markReviewed('${post.id}')">‚úì Mark Reviewed</button>
                                ` : `
                                    <button class="btn btn-secondary" onclick="unmarkReviewed('${post.id}')">‚Ü∂ Unmark</button>
                                `}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function updateStats(posts) {
            const reviewedPosts = getReviewedPosts();
            const newCount = posts.filter(p => !reviewedPosts.has(p.id)).length;
            
            document.getElementById('totalCount').textContent = posts.length;
            document.getElementById('newCount').textContent = newCount;
            document.getElementById('reviewedCount').textContent = reviewedPosts.size;
        }
        
        function getReviewedPosts() {
            try {
                const reviewed = localStorage.getItem('reviewedPosts');
                return new Set(reviewed ? JSON.parse(reviewed) : []);
            } catch (e) {
                return new Set();
            }
        }
        
        function saveReviewedPosts(reviewedSet) {
            localStorage.setItem('reviewedPosts', JSON.stringify([...reviewedSet]));
        }
        
        function markReviewed(postId) {
            const reviewed = getReviewedPosts();
            reviewed.add(postId);
            saveReviewedPosts(reviewed);
            loadPosts();
        }
        
        function unmarkReviewed(postId) {
            const reviewed = getReviewedPosts();
            reviewed.delete(postId);
            saveReviewedPosts(reviewed);
            loadPosts();
        }
        
        function clearAllReviewed() {
            if (confirm('Are you sure you want to clear all reviewed posts?')) {
                localStorage.removeItem('reviewedPosts');
                loadPosts();
            }
        }
        
        function filterPosts(filter) {
            currentFilter = filter;
            
            // Update active tab
            document.querySelectorAll('.filter-tabs button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            loadPosts();
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // Load posts on page load
        loadPosts();
        
        // Auto-refresh every 2 minutes
        setInterval(loadPosts, 120000);
    </script>
</body>
</html>
